{"ast":null,"code":"import { authConstants } from \"./constants\";\nimport axios from \"axios\";\nimport setAuthToken from \"../utils/setAuthToken\";\nimport jwt_decode from \"jwt-decode\";\nimport { GET_ERRORS, SET_CURRENT_USER, USER_LOADING } from \"./types\";\nexport const login = user => dispatch => {\n  // console.log(user);\n  axios.post(\"/admin/signin\", user).then(res => {\n    //Save to localStorage\n    const {\n      token\n    } = res.data;\n    localStorage.setItem(\"jwtToken\", token); //save to localStorage\n\n    setAuthToken(token); //Decode token to get user data\n\n    const decoded = jwt_decode(token); //set current User\n\n    dispatch(setCurrentUser(decoded));\n  }).catch(err => dispatch({\n    type: GET_ERRORS,\n    payload: err.response.data\n  }));\n};\nexport const isUserLoggedIn = () => {\n  return async dispatch => {\n    const token = localStorage.getItem('token');\n\n    if (token) {\n      const user = JSON.parse(localStorage.getItem('user'));\n      dispatch({\n        type: authConstants.LOGIN_SUCCESS,\n        payload: {\n          token,\n          user\n        }\n      });\n    } else {\n      dispatch({\n        type: authConstants.LOGIN_FAILURE,\n        payload: {\n          error: 'Failed to login'\n        }\n      });\n    }\n  };\n};\nexport const signout = () => dispatch => {\n  //Remove token from LOcal Storage\n  localStorage.removeItem(\"jwtToken\"); // Remove token from local Storage\n\n  setAuthToken(false); // Set current user tp empty object{} which will set is Authenticated\n\n  dispatch(setCurrentUser({})); // dispatch({ type: authConstants.LOGOUT_REQUEST });\n  // const res = await axios.post(`/admin/signout`);\n  //\n  // if(res.status === 200){\n  //     localStorage.clear();\n  //     dispatch({ type: authConstants.LOGOUT_SUCCESS });\n  // }else{\n  //     dispatch({\n  //         type: authConstants.LOGOUT_FAILURE,\n  //         payload: { error: res.data.error }\n  //     });\n  // }\n};","map":{"version":3,"sources":["C:/Users/Aman/Desktop/Roc8/Selnyr/admin/src/actions/auth.actions.js"],"names":["authConstants","axios","setAuthToken","jwt_decode","GET_ERRORS","SET_CURRENT_USER","USER_LOADING","login","user","dispatch","post","then","res","token","data","localStorage","setItem","decoded","setCurrentUser","catch","err","type","payload","response","isUserLoggedIn","getItem","JSON","parse","LOGIN_SUCCESS","LOGIN_FAILURE","error","signout","removeItem"],"mappings":"AAAA,SAASA,aAAT,QAA8B,aAA9B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,YAAP,MAAyB,uBAAzB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,SACEC,UADF,EAEEC,gBAFF,EAGEC,YAHF,QAIO,SAJP;AAOA,OAAO,MAAMC,KAAK,GAAIC,IAAD,IAASC,QAAQ,IAAI;AAEtC;AACAR,EAAAA,KAAK,CACJS,IADD,CACM,eADN,EACuBF,IADvB,EAECG,IAFD,CAEMC,GAAG,IAAI;AAEX;AACA,UAAM;AAAEC,MAAAA;AAAF,QAAYD,GAAG,CAACE,IAAtB;AACAC,IAAAA,YAAY,CAACC,OAAb,CAAqB,UAArB,EAAiCH,KAAjC,EAJW,CAMX;;AACAX,IAAAA,YAAY,CAACW,KAAD,CAAZ,CAPW,CASX;;AACA,UAAMI,OAAO,GAAGd,UAAU,CAACU,KAAD,CAA1B,CAVW,CAYX;;AACAJ,IAAAA,QAAQ,CAACS,cAAc,CAACD,OAAD,CAAf,CAAR;AAGD,GAlBD,EAmBCE,KAnBD,CAmBOC,GAAG,IACRX,QAAQ,CAAC;AACPY,IAAAA,IAAI,EAAEjB,UADC;AAEPkB,IAAAA,OAAO,EAAEF,GAAG,CAACG,QAAJ,CAAaT;AAFf,GAAD,CApBV;AA0BH,CA7BM;AA+BP,OAAO,MAAMU,cAAc,GAAG,MAAM;AAChC,SAAO,MAAMf,QAAN,IAAkB;AACrB,UAAMI,KAAK,GAAGE,YAAY,CAACU,OAAb,CAAqB,OAArB,CAAd;;AACA,QAAGZ,KAAH,EAAS;AACL,YAAML,IAAI,GAAGkB,IAAI,CAACC,KAAL,CAAWZ,YAAY,CAACU,OAAb,CAAqB,MAArB,CAAX,CAAb;AACAhB,MAAAA,QAAQ,CAAC;AACLY,QAAAA,IAAI,EAAErB,aAAa,CAAC4B,aADf;AAELN,QAAAA,OAAO,EAAE;AACLT,UAAAA,KADK;AACEL,UAAAA;AADF;AAFJ,OAAD,CAAR;AAMH,KARD,MAQK;AACDC,MAAAA,QAAQ,CAAC;AACLY,QAAAA,IAAI,EAAErB,aAAa,CAAC6B,aADf;AAELP,QAAAA,OAAO,EAAE;AAAEQ,UAAAA,KAAK,EAAE;AAAT;AAFJ,OAAD,CAAR;AAIH;AACJ,GAhBD;AAiBH,CAlBM;AAoBP,OAAO,MAAMC,OAAO,GAAG,MAAMtB,QAAQ,IAAG;AAElC;AACAM,EAAAA,YAAY,CAACiB,UAAb,CAAwB,UAAxB,EAHkC,CAKlC;;AACA9B,EAAAA,YAAY,CAAC,KAAD,CAAZ,CANkC,CAQlC;;AACAO,EAAAA,QAAQ,CAACS,cAAc,CAAC,EAAD,CAAf,CAAR,CATkC,CAWhC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEP,CAxBM","sourcesContent":["import { authConstants } from \"./constants\";\r\nimport axios from \"axios\";\r\nimport setAuthToken from \"../utils/setAuthToken\";\r\nimport jwt_decode from \"jwt-decode\";\r\nimport {\r\n  GET_ERRORS,\r\n  SET_CURRENT_USER,\r\n  USER_LOADING\r\n} from \"./types\";\r\n\r\n\r\nexport const login = (user) =>dispatch => {\r\n\r\n    // console.log(user);\r\n    axios\r\n    .post(\"/admin/signin\", user)\r\n    .then(res => {\r\n\r\n      //Save to localStorage\r\n      const { token } = res.data;\r\n      localStorage.setItem(\"jwtToken\", token);\r\n\r\n      //save to localStorage\r\n      setAuthToken(token);\r\n\r\n      //Decode token to get user data\r\n      const decoded = jwt_decode(token);\r\n\r\n      //set current User\r\n      dispatch(setCurrentUser(decoded));\r\n\r\n\r\n    })\r\n    .catch(err =>\r\n      dispatch({\r\n        type: GET_ERRORS,\r\n        payload: err.response.data\r\n      })\r\n    );\r\n\r\n}\r\n\r\nexport const isUserLoggedIn = () => {\r\n    return async dispatch => {\r\n        const token = localStorage.getItem('token');\r\n        if(token){\r\n            const user = JSON.parse(localStorage.getItem('user'));\r\n            dispatch({\r\n                type: authConstants.LOGIN_SUCCESS,\r\n                payload: {\r\n                    token, user\r\n                }\r\n            });\r\n        }else{\r\n            dispatch({\r\n                type: authConstants.LOGIN_FAILURE,\r\n                payload: { error: 'Failed to login' }\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nexport const signout = () => dispatch =>{\r\n\r\n      //Remove token from LOcal Storage\r\n      localStorage.removeItem(\"jwtToken\");\r\n\r\n      // Remove token from local Storage\r\n      setAuthToken(false);\r\n\r\n      // Set current user tp empty object{} which will set is Authenticated\r\n      dispatch(setCurrentUser({}));\r\n\r\n        // dispatch({ type: authConstants.LOGOUT_REQUEST });\r\n        // const res = await axios.post(`/admin/signout`);\r\n        //\r\n        // if(res.status === 200){\r\n        //     localStorage.clear();\r\n        //     dispatch({ type: authConstants.LOGOUT_SUCCESS });\r\n        // }else{\r\n        //     dispatch({\r\n        //         type: authConstants.LOGOUT_FAILURE,\r\n        //         payload: { error: res.data.error }\r\n        //     });\r\n        // }\r\n\r\n}\r\n"]},"metadata":{},"sourceType":"module"}